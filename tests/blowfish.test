# -*- tcl -*-
# Commands covered:	BLOWFISH
#
# This file contains a collection of tests for one or more of the commands
# the BLOB-X extension. Sourcing this file into Tcl runs the
# tests and generates output for errors.  No output means no errors were
# found.
#
# Copyright (c) 1996 Andreas Kupries (a.kupries@westend.com)
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# $Id$

if {[string compare test [info procs test]] == 1} then {source defs}


#This is a test vector.
#Plaintext is "BLOWFISH".
#The key is "abcdefghijklmnopqrstuvwxyz".

#define PL 0x424c4f57l
#define PR 0x46495348l
#define CL 0x324ed0fel
#define CR 0xf413a203l
#	static char keey[]="abcdefghijklmnopqrstuvwxyz";

#This is another test vector.
#The key is "Who is John Galt?"

#define PL 0xfedcba98l
#define PR 0x76543210l
#define CL 0xcc91732bl
#define CR 0x8022f684l


set key(1) [text2hex "abcdefghijklmnopqrstuvwxyz"]
set key(2) [text2hex "Who is John Galt?"]

array set in {
    1	424c4f5746495348
    2	fedcba9876543210
}

array set out {
    1	324ed0fef413a203
    2	cc91732b8022f684
}


foreach i [lsort [array names key]] {

    test blowfish-1.$i {blowfish encryption} {
	exec_bc blowfish $key($i) {} $in($i) {-dir encrypt -mode ecb -key @key @in @out}
    } [string toupper $out($i)]
}


foreach i [lsort [array names key]] {

    test blowfish-2.$i {blowfish decryption} {
	exec_bc blowfish $key($i) {} $out($i) {-dir decrypt -mode ecb -key @key @in @out}
    } [string toupper $in($i)]
}


# remove globals
unset in out key
