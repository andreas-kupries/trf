# -*- tcl -*-
# Commands covered:	DES (Data Encryption Standard)
#
# This file contains a collection of tests for one or more of the commands
# the BLOB-X extension. Sourcing this file into Tcl runs the
# tests and generates output for errors.  No output means no errors were
# found.
#
# Copyright (c) 1996 Andreas Kupries (a.kupries@westend.com)
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# $Id$

if {[string compare test [info procs test]] == 1} then {source defs}


array set key {
    0	0123456789abcdef
    1	0123456789abcdef
    2	0000000000000000
    3	ef012345
    4	0123456789abcdef
}

array set in {
    0	0123456789abcdef
    1	0000000000000000
    2	0000000000000000
    3	00000000000000000000
    4	0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
}


array set out {
    0	75b7878099e0c596
    1	7494c2e7104b0879
    2	de188941a3375d3a
    3	d6a141a7ec3c38dfbd61
    4	7595c3e6114a09780c4ad452338e1ffd9a1be9498f813d76533449b6778dcad8c78a8d2ba9ac66085d0e53d59c26c2d1c490c1ebbe0ce66d1b6b1b13b6b919b847c25a91447a95e75e4ef16779cde8bf0a95850e32af9689444fd377108f98fdcbd4e726567500990bcc7e0ca3c4aaa304a387d20f3b8fbbcd42a1bd311d7a4303dda5ab078896ae80c18b0af66dff319616eb784e495ad2ce90d7f772a81747b65f62093b1e0db9e5ba532fafec47508323e671327df9444432cb7367cec82f5d44c0d00b67d650a075cd4b70dedd77eb9b10231b6b5b741347396d62897421d43df9b42e446e358e9c11a9b2184ecbef0cd8e7a877ef968f1390ec9b3d35a5585cb009290e2fcde7b5ec66d9084be44055a619d9dd7fc3166f9487f7cb272912426445998514c15d53a18c864ce3a2b7555793988126520eacf2e3066e230c91bee4dd5304f5fd0405b35bd99c73135d3d9bc335ee049ef69b3867bf2d7bd1eaa595d8bfc0066ff8d31509eb0c6caa006c807a623ef84c3d33c195d23ee320c40de0558157c822d4b8c569d849aed59d4e0fd7f379586b4b7ff684ed6a189f7486d49b9c4bad9ba24b96abf924372c8a8fffb10d55354900a77a3db5f205e1b99fcd8660863a159ad4abe40fa48934163ddde542a6585540fd683cbfd8c00f12129a284deacc4cdefe58be7137541c047126c8d49e2755ab181ab7e940b0c0
}


foreach i [lsort [array names key]] {

    test rc4-1.$i {rc4 encryption} {
	exec_bc rc4 $key($i) {} $in($i) {-dir encrypt -key @key @in @out}
    } [string toupper $out($i)]
}


foreach i [lsort [array names key]] {

    test rc4-2.$i {rc4 decryption} {
	exec_bc rc4 $key($i) {} $out($i) {-dir decrypt -key @key @in @out}
    } [string toupper $in($i)]
}


# remove globals
unset in out key
