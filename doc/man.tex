% -*- latex -*-
\documentclass {report}
\usepackage    {makeidx}
\usepackage    {html}
\include       {defs}
\makeindex

% external, but distributed here too
\def\install{	\htmladdnormallink {install.tex}	 {../install/install.html}}
\def\installman{\htmladdnormallink {installation manual} {../install/install.html}}
\def\capi{      \htmladdnormallink {C-level} {../capi/capi.html}}
\def\capiref{   \htmladdnormallink {online reference} {../capi/capi.html}}
\def\manps{     \htmladdnormallink{postscript version}{man.ps.gz}}
%\def\strterm{$\backslash 0$} (defs.tex)

% remove this for the official release.
%\def\unoff{
%	\strong{Beware:} This is an unofficial and unannounced
%	release, just to have a complete web site. The official
%	distribution will be made as soon as tcl 8.0b1 is out. Because
%	of this no binary release for \win{} was made, too.}


\begin {document}

\title{The \trf {} (transformer) extension to Tcl}
\author{Andreas Kupries \\ Aachen}
\date{\today}
\maketitle 

\begin{htmlonly}
\begin{center}\large
	This document accompanies \trf{} @mFullVersion@, as
	distributed at @mDate@.
\end{center}

A \manps{} is available.
\index{postscript version}
% much more indexing is required!

\strong{Warning:} The contents of this document are likely to change.
It is advisable not to use links to any pages other than the first
page (this page).
\end{htmlonly}

\begin{abstract} 
\trf {} is an extension library to the script language \tcl, as created
by \jo. It extends the language at the C-level with so-called
``transformer''-procedures. With the help of some patches to the core
the package is able to intercept all read/write operations on
designated channels, thus giving it the ability to transform the
buffer contents as desired. This allows things like transparent
encryption, compression, charset recoding, etc.
Build upon this framework (and as proof of concept) a collection of
\tcl{}-level commands was implemented, most of them related to
cryptography. Additionally some binary data support is put in as well.
\end{abstract} 
\pagebreak
\tableofcontents

\chapter {Introduction}
This is the reference manual of Tcl-Trf @mFullVersion@, as distributed
at @mDate@. For instructions on how to compile and install it see
\file {\install} or one of its derivatives (\file {install.dvi},
\html{\htmladdnormallink{install.ps}{install.ps.gz}}
\latex{\file{install.ps}}).

%\unoff

After torturing the world with 2 extensions related to binary support
in tcl (\blob{} and \blobx{}) I could not resist and wrote another
one :-). It can be seen as a merger of features from these 2, but in
contrast to them it is build on top of the binary data support coming
in tcl8.0, aka

\begin{itemize}
\item	the \cmd{binio} command,
\item	memory channels,
\item	and transformation procedures.
\end{itemize}

\strong {This is not true in the current implementation}. Please read
the \installman{} to gain insight into the requirements of this
extension.

At the \capi{} a set of commands is provided for management,
implementation and usage of ``transformer''-procedures. These are
called by the (patched) generic channel system to pre- or postprocess
data just before writing, resp. immediately after reading. This allows
transparent implementation of things like:

\begin {itemize}
\item	Gathering statistics about the data flowing through a channel.
% This I had in the first implementation, should port it to this one too.

\item	Converting in and out of printable representations of binary
	data.
\item	Decryption, encryption of information read or written.
\item	Data de(compression), error correcting coding.
\end   {itemize}
to name only a few.

As proof of concept several such algorithms were implemented and are
provided as user-commands at the \tcl{}-level. As most of them are
related to cryptography in one way or another, this library might be
seen as cryptographic toolkit too.


\chapter {Where to get}

This library is available at
\begin {itemize}
\item[] Primary urls:
\begin {itemize}
\item[Sources:]			  \url {ftp://ftp.westend.com/pub/aku/trf@mFullVersion@.tar.gz} (~1 M)
\item[Same, different archiver:]  \url {ftp://ftp.westend.com/pub/aku/trf@mFullVersion@.zip}    (~1 M)
\item[Short documentation:]	  \url {ftp://ftp.westend.com/pub/aku/trf@mFullVersion@.README} (~2 K)
\item[Win32 binary distribution:] \url {ftp://ftp.westend.com/pub/aku/trf@mShortDosVersion@-win32.zip} (~260 K)
\end {itemize}

%%\item[] Secondary urls:
%%\begin {itemize}
%%	\item \url {ftp://ftp.kisters.de/pub/lang/tcl/ext/trf@mFullVersion@.tar.gz} (~1 M)
%%	\item \url {ftp://ftp.kisters.de/pub/lang/tcl/ext/trf@mFullVersion@.zip}    (~1 M)
%%	\item \url {ftp://ftp.kisters.de/pub/lang/tcl/ext/trf@mFullVersion@.README} (~2 K)
%%	\item \url {ftp://ftp.kisters.de/pub/lang/tcl/ext/trf@mShortDosVersion@-win32.zip} (~260 K)
%%\end {itemize}
\end {itemize}


\chapter {Acknowledgements, Disclaimer}

\section {Acknowledgements}
\begin {itemize}\Large
\item	Guess who ? \jo{} for \tcl {} itself. 
\item	\jyl
\item	\bast{} for general friendship.
\item	\greyham{} for \cmd {c2man}.
\item	\jan{} for support, encouragement
	(transformation procedures as part of his plus-patches) and
	several patches enhancing the usability (load-on-demand of
	libz, \dots{}) of this package.
\item	In no particular order: \gookkimn{}, \rvaldez{}, \gvvaughan{}
	and \fmeyer{}.
\end   {itemize}

Neither the encryption algorithms nor the message digests were
implemented by myself, they are all from other persons. See chapter
\ref {copyright} for more information.

\section {Disclaimer}

This software is copyrighted by Andreas Kupries.  The following
terms apply to all files associated with the software unless explicitly
disclaimed in individual files.

The author hereby grant permission to use, copy, modify, distribute,
and license this software and its documentation for any purpose, provided
that existing copyright notices are retained in all copies and that this
notice is included verbatim in any distributions. No written agreement,
license, or royalty fee is required for any of the authorized uses.
Modifications to this software may be copyrighted by their authors
and need not follow the licensing terms described here, provided that
the new terms are clearly indicated on the first page of each file where
they apply.

IN NO EVENT SHALL THE AUTHOR OR DISTRIBUTORS BE LIABLE TO ANY PARTY
FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OF THIS SOFTWARE, ITS DOCUMENTATION, OR ANY
DERIVATIVES THEREOF, EVEN IF THE AUTHOR HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.

THE AUTHOR AND DISTRIBUTORS SPECIFICALLY DISCLAIM ANY WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.  THIS SOFTWARE
IS PROVIDED ON AN "AS IS" BASIS, AND THE AUTHOR AND DISTRIBUTORS HAVE
NO OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR
MODIFICATIONS.


\chapter {Danger ahead}

First some remarks regarding the work with binary data (and this
package) in general:

\begin {enumerate}
\item	Whatever you do, don't forget to switch the used channels into
	binary mode, i.e. execute ``fconfigure $<$channel$>$ -translation
	binary''. Not doing this will produce all kind of strange
	errors, even on unix machines, as the default translation mode
	(``auto'') will not only convert CR LF into LF, but a single
	CR as well!

\item	Using transformation procedures (as in this package)
	introduces an additional level of buffering because they are
	permitted to buffer all characters they are unable to process
	immediately. This may mess up especially
	interprocess communication, a notoriously problematic field. A
	not so improbable scenario would be the addition of encryption
	to enhance security. Using a blockcipher here may lead to the
	following problem (a line-oriented protocol is assumed):

	\begin {itemize}
	\item	The sender produces a line and writes it into the channel,
		waiting for a response from the receiver afterward.
	\item	The channel system invokes the blockcipher to encrypt
		the line, but not all characters are encrypted due to
		the length of the line not being a multiple of the
		blocksize. Especially the EOL-character is neither
		encrypted, nor transmitted.
	\item	The receiver decrypts the blocks it got, then waits
		for the EOL character.
	\item	\strong {DEADLOCK}.
	\end   {itemize}

	The solution here would be the usage of a blockcipher in CFB
	mode and shift $=$ 1 or that of a stream cipher, as both of these
	would encrypt single characters without buffering.

	Data compression is another good candidate for such a situation.

	Because of this I decided to include the number of characters
	buffered by a certain transformation in its description.

\end   {enumerate}


\chapter {The available commands}

First a small note: This manual deals with the \tcl{}-level commands
only. For a description of the C-level API please read the
manpages\html{ or the \capiref{}}.


All commands are available in 2 modes of operation, ``immediate'' and
``attached''.  The generic syntactical forms of these modes are:

\begin {itemize}
\item [immediate:]	\cmd {command} -option arg {value} \dots{} \arg {sourcevalue}

	In this mode the command processes the given \arg {sourcevalue}
	and returns the transformed information as interpreter
	result. With \tcl{} 7.6 this may yield incorrect results due
	to embedded \strterm{} characters, either in source or result.

	To allow for correct operation with this version too 2
	additional options are provided: \opt {-in} and \opt {-out}.

	If \opt {-in} is present, its argument is interpreted as
	channelhandle and the data to transform is read from it. A
	\arg{sourcevalue} \strong {must not} be specified in that case.

	If \opt {-out} is present, its argument is interpreted as
	channelhandle and the transformation result will be written
	into it.

	Please note that it is \strong {not} necessary to specify both
	options, each of them can be used alone.



\item [attached:]	\cmd {command} -attach \arg {channel} -option \arg {value} \dots{}

	This creates a channel filter, configured as defined by the
	options and then attached to the \arg {channel}. All data read
	from or written into the \arg {channel} will be transformed
	accordingly from now on.

	Neither \opt {-in}, nor \opt {-out}, nor a \arg {sourcevalue}
	must be specified here.

	This mode is the one requiring the patches to the
	core. Without them we would be unable to stack our
	transforming channel onto the named one.
\end   {itemize}


\section {Encryption}

The ciphers implemented here are

\begin {enumerate}
\item	DES 	(the dinosaur)
\item	IDEA	(used by \PGP)
\item	Blowfish
\item	RC2
\item	RC4
\item	Rot (cesar cipher, rot13)
\item	SAFER (\strong {S}ecure \strong {A}nd \strong {F}ast
		\strong {E}ncryption \strong {R}outine)
\end   {enumerate}

The commands to invoke them are identical to the names, converted to
all lowercase. Options common to them all:

\begin {itemize}
\item [-direction]	Allowed values are ``encrypt'', ``decrypt'' and all
			unique abbreviations. Specifies the operation
			to be executed in immediate mode or the
			operation executed upon \strong {write} if
			attached to a channel.

\item [-key]		The argument to this options specifies the key
			to be used by the cipher. The exact
			interpretation depends on the value of option
			\opt {-key-type}. Possibilities are:

	\begin {itemize}
	\item [data]	The argument immediately contains the
			key. This might yield incorrect data under
			\tcl{} 7.6, due to embedded \strterm{}'s.

	\item [channel]	The handle of a readable channel.
	\end   {itemize}

			The minimum and maximum number of bytes to be
			used/read are cipher dependent and will be
			described later.

\item [-key-type]	Possible values are \strong {data},
			\strong {channel} and all unique abbreviations
			of these. If this option is not given,
			\strong {data} will be used as default.
\end   {itemize}

The first 4 ciphers are blockciphers, i.e. they do not encrypt single
characters, but blocks of 2 or more. Such ciphers can be operated in 4
different modes and therefore have additional options defined:

\begin {itemize}
\item [-mode]	The 4 possible argument values (and modes) are:

	\begin {itemize}
	\item [ecb]	$=$ \strong {e}lectronic \strong {c}ode\strong {b}ook.
	\item [cbc]	$=$ \strong {c}ipher \strong{b}lock \strong{c}haining.
	\item [cfb]	$=$ \strong {c}ipher \strong {f}eed\strong {b}ack.
	\item [ofb]	$=$ \strong {o}utput \strong {f}eed\strong {b}ack.
	\end   {itemize}

		Only ``ecb'' neither requires a shift value nor an
		initialization vector (see options below). All other
		(``stream'') modes require the initialization vector,
		the feedback modes additionally need a shift value.

		The number of characters buffered internally depends
		both on cipher and operation mode. In 'ebc'- and
		'cbc'-modes blocksize-1 characters are buffered. The
		feedback modes buffer shift-1 characters.


\item [-iv]	The argument to this options specifies the
		initialization vector required by the stream modes of
		the blockcipher. The exact interpretation depends
		on the value of option \opt {-iv-type}. See option
		\opt {-key} above for an explanation of possibilities
		and their meaning. A complete block must be specified.

\item [-iv-type]	See option \opt {-key-type} above for an
			explananation.

\item [-shift]	Only integer numbers are allowed as values to this
		option. It defines the number of bytes the feedback
		register is shifted to the left after every
		encryption. Only positive values not larger than the
		blocksize are allowed. They must be a divisor of the
		blocksize too!
\end   {itemize}


Cipher characteristics:

\begin {center}
	\begin {tabular}{|l|l|l|}\hline
	Name		& Blocksize (in byte)	& Keysize (in byte) \\ \hline\hline
	DES		& 8			& 8 (without MSB!) \\ \hline
	IDEA		& 8			& 16 \\ \hline
	Blowfish	& 8			& 1 - 56 \\ \hline
	SAFER		& 8			& 8, 16 \\ \hline
	RC2		& 8			& 1 - $\infty$ \\ \hline\hline
	RC4		& -			& 1 - 256 \\ \hline
	Rot		& -			& 1	\\ \hline
	\end   {tabular}
\end   {center}

The SAFER blockcipher understands 2 additional options:

\begin {itemize}
\item [-strong-schedule]
	The argument is a boolean value. It determines wether a
	stronger keyschedule is used or not. Defaults to \strong {no}.

\item [-rounds]
	The integer argument specifies the number of rounds used
	during operation. Must be greater than 0 and smaller than to
	14. The default value depends on the chosen keyschedule and
	the length of the key:

	\begin {tabular} {|l|l|l|}\hline
	Strong schedule & Keylength & Default	\\ \hline\hline
	0		&  8	    &	 6	\\ \hline
	0		& 16	    &	10	\\ \hline
	1		&  8	    &	 8	\\ \hline
	1		& 16	    &	10	\\ \hline
	\end  {tabular}
\end   {itemize}

\section {Message digests}

10 message digests are implemented:

\begin {enumerate}
\item	2 crc checkers, taken from \PGP{} and library \zlib, under
	the names \cmd {crc} and \cmd {crc-zlib} resp.
\item	The adler-checksum, taken from \zlib{} too.
\item	MD2, MD5
\item	SHA (or SHS), SHA-1
\item	HAVAL
\item	\rmd, -128
\end   {enumerate}

The commands to invoke them are identical to the names, converted to
all lowercase. In immediate mode no options are allowed. Attached
digests have two submodes available:

\begin {itemize}
\item [-mode]
	The allowed arguments are ``absorb'', ``write'',
	``transparent'' and all unique abbreviations. 

	In the first submode written data is not changed except for
	attachment of the message digest at the end of the
	input. During reading a digest is computed too and then
	compared to the one attached. The '-matchflag' must be defined
	to propagate the result of the comparison to the tcl-level
	(``ok'' or ``failed'').

	In the second submode read or written data goes into nirvana,
	their digests are computed as side effect. After the channel
	is closed the computed digests are written to the variables
	and/or channels specified with '-read/write-destination'.

	The ``transparent'' mode is a mixture of both of the above. As
	with ``absorb'' all data flows through the filter
	unchanged. The generated digests however are handled the same
	way as is done by the ``write''-mode.


\item [-matchflag]
	The value specifies the name of global variable to write the
	result of a digest comparison into. Allowed for mode
	``absorb'' only. Its definition for a write-only channel will
	be ignored. 

\item [-write-destination]
	The value is either interpreted as the name of a global
	variable or the handle of a writable channel, dependent on the
	value of \opt {-write-type}. The message digest computed for
	data written to the attached channel is written into it after
	closing the attached channel. Allowed for mode ``write''
	only. Its definition for a readonly channel is ignored. Using
	a variable may yield incorrected results under \tcl{} 7.6, due
	to embedded \strterm's. 

\item [-write-type]
	Possible values are \strong {variable}, \strong {channel} and
	all unique abbreviations of these. If this option is not
	given, \strong {variable} will be used as default. See \opt
	{-write-destination} above for meaning and usage.

\item [-read-destination]
	The value is either interpreted as the name of a global
	variable or the handle of a writable channel, dependent on the
	value of \opt {-read-type}. The message digest computed for
	data read from the attached channel is written into it after
	closing the attached channel. Allowed for mode ``write''
	only. Its definition for a readonly channel is ignored. Using
	a variable may yield incorrected results under \tcl{} 7.6, due
	to embedded \strterm's.

\item [-read-type]
	See \opt {-write-type} above for an explanation of values and meaning.
\end   {itemize}


\section {Data conversion}

All data conversion commands support only one option,
``-mode''. Allowed values are ``encode'', ``decode'' and all unique
abbreviations. It specifies the operation to be executed in immediate
mode or the operation executed upon \strong {write} if attached to a
channel.

Encode converts from binary data into the described representation,
decode does the reverse (obviously :-).

Standard conversions are
\begin {itemize}
\item [bin]	Converts bytes into dual representation.
\item [oct]	Converts bytes into octal representation.
\item [hex]	Converts bytes into hexadecimal representation.
\end   {itemize}
None of them buffers characters internally.

\begin {itemize}
\item [uuencode] Blocks of 3 characters are uuencoded/decoded. Will
		buffer 2 characters internally until a block is complete.
\item [base64]	Blocks of 3 characters are
		base64-encoded/decoded. This is equivalent to \PGP{}'s
		ASCII armor. Used by MIME too. Will buffer 2
		characters internally until a block is complete.
\item [ascii85]	Blocks of 4 characters will be encoded into Ascii85
		representation as defined in the 'Postscript Reference
		Manual' (2nd Edition, section 3.13, page 129).
\end   {itemize}
All of these are able to convert an incomplete block at the end of
input.

\section {Misc.}

5 other commands are available, not fitting into the categories above:

\begin	{enumerate}
\item	\cmd {transform}. This implements a general transformation.
	The underlying functionality is made available to the script
	level. Options understood are:

	\begin	{itemize}
	\item [-mode]
		Allowed arguments are ``read'', ``write'' and all
		unique abbreviations of these. This option is relevant
		and required only for immediate operation. It
		determines the operations to execute. 

	\item [-command]
		Its specification is always required, and interpreted
		as the script to execute on behalf of the
		channel filter.

		The system will append two arguments to the script
		before execution, the name of the operation and a
		buffer to operate on.
	\end	{itemize}

	The operations and their meaning are:
	\begin {center}
	\begin {tabular}{l|p{8cm}}
	Operation	& Meaning					\\ \hline
	create/write	& Initialize state of transformation for
			  writing into channel. The buffer is
			  irrelevant, and empty. A return value is
			  ignored. First call for writing part. 	\\
	delete/write	& Cleanup state of transformation for
			  writing into channel. The buffer is
			  irrelevant, and empty. A return value is
			  ignored. Last call for writing part.		\\
	write		& Execute write transformation on the given
			  buffer. The return value is interpreted as
			  transformation result.			\\
	flush/write	& Flush out all buffers internal to the
			  transformation. The given buffer is
			  empty. The return value is interpreted as
			  transformation result.			\\
	clear/write	& Cleanup state of transformation for
			  writing into channel. The buffer is
			  irrelevant, and empty. A return value is
			  ignored.					\\ \hline

	create/read	& Initialize state of transformation for
			  read from channel. The buffer is
			  irrelevant, and empty. A return value is
			  ignored. First call for reading part. 	\\
	delete/read	& Cleanup state of transformation for
			  read from channel. The buffer is
			  irrelevant, and empty. A return value is
			  ignored. Last call for reading part.		\\
	read		& Execute read transformation on the given
			  buffer. The return value is interpreted as
			  transformation result. Normally the inverse
			  of the write transformation.			\\
	flush/read	& Flush out all buffers internal to the
			  transformation. The given buffer is
			  empty. The return value is interpreted as
			  transformation result. Required to get
			  buffered partial results at EOF of the
			  underlying channel.	 			\\
	clear/read	& Cleanup state of transformation for
			  read from channel. The buffer is
			  irrelevant, and empty. A return value is
			  ignored. Called during seeks on the channel. \\ \hline
	\end   {tabular}
	\end   {center}

	Using this command under \tcl{} 7.6 will yield incorrect
	results if the buffer to be transformed contains embbeded
	\strterm's.
	

\item	A reed-solomon error correcting coder is available under the
	name \cmd {rs\_ecc}. The one and only option understood is
	``-mode''. It is equivalent to the option understood by the
	conversion commands in the last section. The coder operates on
	blocks of 248 characters each, therefore buffering 247
	characters.

\item	A compressor based upon the \zlib{}-library. It is
	available under the name \cmd {zip} and understands the
	following options:

	\begin	{itemize}
	\item [-mode]	Allowed arguments are ``compress'',
			``decompress'' and all unique abbreviations of
			these.
	\item [-level]	Possible arguments are ``default'' and integer
			numbers in the range 1 \dots{} 9. It specifies
			the used compression level.
	\end	{itemize}

\item	\cmd {unstack}. This command must be used to remove a
	conversion channel. The underlying channel is uncovered and
	accessible again afterward. It requires a channelhandle as its
	one and only argument. Its application to a normal channel
	(file, socket, \dots {}) is identical to \cmd {close}.

\item	\cmd {binio}. See file \file {doc/binio.proposal}
	for more information. This command is excluded by default, as
	tcl 8.0 now provides equivalent functionality (See commands
	\cmd {binary} and \cmd {fcopy}). Inclusion requires
	application of the byteorder patch. See the \installman{} for
	more information.
\end	{enumerate}


\section {Quick Reference}
Now a quick reference describing the available commands, their type of
algorithm and location of implementation of the underlying
algorithm. The format specifiers available to \cmd {binio} can be
found in a separate table afterward.

\begin {center}
\begin {tabular}{|l|l|l|}\hline
	Command		& Type				& Location \\ \hline\hline
	adler		& Message digest		& \zlib	\\ \hline
	ascii85		& Conversion			& \trf	\\ \hline
	base64		& Conversion			& \trf	\\ \hline
	bin		& Conversion			& \trf	\\ \hline
	binio		& Binary I/O			& \trf	\\ \hline
	blowfish	& Blockcipher			& \trf	\\ \hline
	crc		& Message digest		& \trf	\\ \hline
	crc-zlib	& Message digest		& \zlib	\\ \hline
	des		& Blockcipher			& \SSLeay \\ \hline
	haval		& Message digest		& \trf	\\ \hline
	hex		& Conversion			& \trf	\\ \hline
	idea		& Blockcipher			& \trf	\\ \hline
	md2		& Message digest		& \SSLeay \\ \hline
	md5		& Message digest		& \trf	\\ \hline
	oct		& Conversion			& \trf	\\ \hline
	rc2		& Blockcipher			& \SSLeay \\ \hline
	rc4		& Cipher			& \trf	\\ \hline
	rot		& Cipher			& \trf	\\ \hline
	ripemd160	& Message digest		& \trf	\\ \hline
	ripemd128	& Message digest		& \trf	\\ \hline
	rs\_ecc		& Error correcting coder	& \trf	\\ \hline
	safer		& Blockcipher			& \trf	\\ \hline
	sha		& Message digest		& \trf	\\ \hline
	sha1		& Message digest		& \SSLeay \\ \hline
	transform	& General transformation	& \trf	\\ \hline
	unstack		&				& \trf	\\ \hline
	uuencode	& Conversion			& \trf	\\ \hline
	zip		& Data compression		& \zlib	\\ \hline
\end {tabular}
\end {center}

The next one is more than a table of the format specifiers available to
\cmd{binio}. It includes a comparison to \cmd{binary format} of tcl
8.0 too.

\begin {center}
\begin {tabular}{|l|l|l|}\hline
Format & Meaning		& Meaning in 8.0 \\ \hline\hline
a & --				& string, '\strterm'-padded		\\ \hline
A & --				& string, space-padded			\\ \hline
b & --				& binary digits, low-2-high		\\ \hline
B & --				& binary digits, high-2-low		\\ \hline
c & signed int, 8 bit (char)	& see left				\\ \hline
C & unsigned int, 8 bit		& --					\\ \hline
d & signed int, 32 bit		& floating number, 64 bit		\\ \hline
D & signed int, 16 bit		& --					\\ \hline
f & floating number, 32 bit	& see left.				\\ \hline
F & floating number, 64 bit	& --					\\ \hline
h & --				& hex digits, low-2-high		\\ \hline
H & --				& hex digits, high-2-low		\\ \hline
i & --				& signed int, 32 bit, little endian	\\ \hline
I & --				& signed int, 32 bit, big-endian	\\ \hline
l & signed int, 64 bit		& --					\\ \hline
L & unsigned int, 64 bit	& --					\\ \hline
o & signed int, 32 bit, octal	& --					\\ \hline
O & signed int, 16 bit, octal	& --					\\ \hline
s & string, '\strterm'-terminated & signed int, 16 bit, little-endian	\\ \hline
S & --				& signed int, 16 bit, big-endian	\\ \hline
u & unsigned int, 32 bit	& --					\\ \hline
U & unsigned int, 32 bit	& --					\\ \hline
x & signed int, 32 bit, hex	& '\strterm'				\\ \hline
X & signed int, 16 bit, hex	& Set cursor relative			\\ \hline
@ & --				& Set cursor absolute			\\ \hline
\end {tabular}
\end {center}

There is a more subtle difference too. In contrast to \cmd {binio},
which uses the channel byteorder to determine the endianness of the
written data \cmd{binary format} requires an explicit specification. In
general \cmd{binary format} is much nearer to the perl equivalent
((un)pack), despite the names.



\chapter {Copyrights}\label {copyright}

Copyright notes and acknowledgements for the different ciphers,
message digests, \dots {}:

\begin {enumerate}
\item	MD5 is copyright '\rsadsi{}'. The note at the
	beginning of \file {md5.h} says:

	\begin {quotation}
		License to copy and use this software is granted
		provided that it is identified as the "\rsadsi{} MD5
		Message-Digest Algorithm" in all material mentioning
		or referencing this software or this function.
                                                                  
		License is also granted to make and use derivative
		works provided that such works are identified as
		"derived from the \rsadsi{} MD5 Message-Digest
		Algorithm" in all material mentioning or referencing
		the derived work.
	\end   {quotation}

	I consider the terms of the license fulfilled by this
	quotation. 

\item	HAVAL is copyright \yuliang{} and may not be sold or used as
	inducement to buy a product without the written permission of
	\yuliang{}. For technical questions or questions regarding the
	code used here contact the copyright holder.

	He will be on sabbatical leave at the Institute of Industrial
	Science, University of Tokyo from March 1997 to February 1998.
	The email address will be \mailaddr {yuliang@imailab.iis.u-tokyo.ac.jp}.

	I made some minor changes to eliminate masses of \cmd
	{gcc}-warnings regarding operator priority in expressions, but
	did not change the semantics.


\item	SHA / SHS was specified by the US government agency
	\NIST. Primary author of the code used here seems to be
	\pgutmann, with heavily modifications from \uh. 

\item	The implementation of DES (libdes) used here is copyrighted by
	\eay.

\item	IDEA (International Data Encryption Algorithm) is a block
	cipher developed  by  Dr. Xuejia Lai  and \massey{} at the \sfit{}.

	The implementation used here was written by \demoliner.

	\strong {Warning}:
	\begin {quotation}
		The IDEA(tm) block cipher is covered by a patent held
		by ETH and a Swiss company called \ascom{}.  The
		Swiss patent number is PCT/CH91/00117.  International
		patents are pending. IDEA(tm) is a trademark of
		\ascom{}.  \strong {There is no license fee required for
		noncommercial use}.  Commercial users may obtain
		licensing details from Dieter Profos, \ascom{},
		Solothurn Lab, Postfach 151, 4502 Solothurn,
		Switzerland, Tel +41 65 242885, Fax +41 65 235761. 
	\end {quotation}

\item	SAFER (Safe And Fast Encryption Routine) is a block cipher
	developed by \massey{} at the \sfit{}. The development was
	sponsored by Cylink, Sunnyvale, CA, USA. From the file
	\file{generic/safer/SAFERCMD.TXT}:

	\begin {quotation}
		Although our design of SAFER K-64 was sponsored  by
		Cylink Corporation  (Sunnyvale,  CA,  USA),  Cylink
		has explicitly relinquished any proprietary rights to
		this algorithm.  This largesse  on the part of Cylink
		was motivated by the reasoning that the company would
		gain more from new business  than it  would  lose from
		competition should many new users adopt this publicly
		available cipher.  SAFER  K-64  has  not  been
		patented  and, to the best of our knowledge, is free
		for use by anyone without fees of any kind and with no
		violation  of any rights of ownership, intellectual or
		otherwise.
	\end {quotation}

	The implementation used here was written by \demoliner.


\item	Blowfish is a block cipher invented by \schneier{}, it is
	decribed in the 2nd edition of his book ``Applied
	Cryptography''. His sources were used, with small
	modifications to interface it with this package.

	The statement of the author about the legal state of the
	algorithm:

	\begin {quotation}
		Blowfish is unpatented, and will remain so in all
		countries. The algorithm is hereby placed in the
		public domain, and can be freely used by anyone.
	\end {quotation}

\item	RC4 was invented by \rsadsi{} and considered a ``Trade
	Secret''. Somewhere in this big world it was reengineered and
	the result made public, rendering the secret useless.

	I don't know that \rsadsi{} will try to inflict on people using
	it in the USA. Use it at your own risk.

\item	The Reed-Solomon error correcting coder is copyrighted by
	\paulf{} under the terms of the GNU General Public License.

\item	The library \zlib{} ((de)compression) is copyrighted by
	\jlgailly{} and \madler.

\item	\rmd{} is copyright \dobbertin{}, \bosselaers{} and \preneel{}.
\end   {enumerate}


\chapter {Future}

Things to be done in future.

\begin {itemize}
%% \item	The tests are incomplete, expand them.
%%	done

\item	Add more ciphers (\PGP!). Take a look at \pgplib{} by
	\tage{}.
%	\strong {Hm, better make a separate package. This is
%	primarily a transformer package, not a crypto toolkit}.

%%\item	Transparent mode for digests.
%%	Mixture of 'absorb' and 'write'.

\item	Channel doing special framing after a fixed (user-defined)
	number of characters

\item	Random-byte generator (as real channeltype, no
	transformation!).
%	\strong {Better place it with memchan}.

%%\item	Identity-transformation with ability to gather statistics
%%	about the information flowing through it.
%% not needed anymore, use 'transform' instead!

\item	Anybody out there wishing more ? Feel free to send \me{}
	suggestions.
\end   {itemize}


\printindex
\end {document}
